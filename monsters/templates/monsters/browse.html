{% extends "monsters/sub_nav.html" %}

{% block li_browse_att %}active{% endblock %}

{% block head2 %}
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the controls package.
      google.charts.load('current', {'packages':['corechart', 'controls']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawDashboard);

      // Callback that creates and populates a data table,
      // instantiates a dashboard, a range slider and a pie chart,
      // passes in the data and draws it.
      function drawDashboard() {

        // Create our data table.
        var data = new google.visualization.arrayToDataTable([
            {{ monster_columns|safe }},
            {{ monster_rows|safe }}
          <!--['month', 'data1', 'data2'],-->
          <!--[new Date(2017,1,1), 1, 2],-->
          <!--[new Date(2017,2,1), 3, 7],-->
          <!--[new Date(2017,3,1), 4, 8],-->
          <!--[new Date(2017,4,1), 5, 9],-->
          <!--[new Date(2017,5,1), 6, 10]-->
        ]);

        // Create a dashboard.
        var dashboard = new google.visualization.Dashboard(
            document.getElementById('dashboard_div'));

        // Create a range slider, passing some options
        var rangeSlider = new google.visualization.ControlWrapper({
          'controlType': 'CategoryFilter',
          'containerId': 'cr_filter_div',
          'options': {
            'filterColumnLabel': 'cr',
            ui: {
              sortValues: false,
            }
          }
        });

        // Create a string filter, passing some options
        var nameFilter = new google.visualization.ControlWrapper({
          'controlType': 'StringFilter',
          'containerId': 'name_filter_div',
          'options': {
            'filterColumnLabel': 'name',
            'matchType': 'any',
          }
        });

        // Create a table, passing some options
        var table = new google.visualization.ChartWrapper({
          'chartType': 'Table',
          'containerId': 'chart_div',
          'options': {
            'width': '100%',
            <!--'height': 300,-->
            'allowHtml': true,
          }
        });

        // Establish dependencies
        dashboard.bind(rangeSlider, table);
        dashboard.bind(nameFilter, table);

        // Draw the dashboard.
        dashboard.draw(data);

      }
    </script>
    <style>
    body {font-family: Arial, Helvetica, sans-serif;}

    /* The Modal (background) */
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        padding-top: 100px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content */
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
    }

    /* The Close Button */
    .close {
        color: #aaaaaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
    }
    </style>
{% endblock %}

{% block content2 %}
  <h1>Monster List</h1>

<div id="myModal" class="modal">

  <!-- Modal content -->
  <div id="modal" class="modal-content">
    <span class="close">&times;</span>
    <p>Some text in the Modal..</p>
  </div>

</div>


<script>
// Get the modal
var modal = document.getElementById('myModal');

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}

// When the user clicks on div, open the popup
function getRollSim(id, count, die, mod) {
    <!--ajax to get roll sim-->
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          document.getElementById(id).innerHTML =
          this.responseText;
        }
    };
  xhttp.open("GET", "/roller?count=" + count + "&die=" + die + "&mod=" + mod, true);
  xhttp.send();

    var popup = document.getElementById(id);
    popup.classList.toggle("show");
}
</script>
<script>
<!--axaj to get monster details-->
function loadDescript(text) {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      document.getElementById("modal").innerHTML =
      this.responseText;
    }
  };
  xhttp.open("GET", "/monsters/deets?name="+text, true);
  xhttp.send();
  modal.style.display = "block";
}
</script>

  <div id="dashboard_div" style="width: 90%; align: center; margin:0 auto; display: block">
      <!--Divs that will hold each control and chart-->
      <div style="width: 100%; align: center; margin:0 auto; display: block">
        <table>
          <tr>
            <td style="width: 50%"><div id="name_filter_div" style="float: left;"></div></td>
            <td style="width: 50%"><div id="cr_filter_div" style="float: right;"></div></td>
          </tr>
        </table>
      </div>
      <br>
      <div id="chart_div" style="width: 100%; display: block; margin:0 auto;"></div>
  </div>

{% endblock %}
